import unittest
from main_function_AJmodel1_chr1 import main

class MyMain(unittest.TestCase):
    def test_basic(self):
        arguments  = ['',1,'ill_650_test.bed',1000000,1234567,'rand',1]
        results = main(arguments)
        print results
        self.maxDiff = None
        expected_results = [[13110, 4061, 1855, 0.12410289299728697, 11487, 2769, 1728, 0.4006030049168712, 6260, 1842, 1744,
          0.5987281094820065, 0.03898024656205057, 0.17240637027163652, 0.1769278097317415, 0.0, 17.54653994405594,
          18.824277224806199, 24.179831777777775, 0.0, 0.0, 0.0, 19.458056853046592, 18.164512680203046,
          18.546433526315788, 0.0, 15.3986, 16.740224000000001, 33.419339999999998, 0.0, 0.0, 0.0, 16.740224000000001,
          14.90842, 15.854153999999999, 0, 143, 129, 45, 0, 0, 0, 279, 197, 190, 0.0, 98.963486886943201,
          106.56337769549555, 127.06545231559008, 0.0, 0.0, 0.0, 111.0572409645599, 116.72103978359902,
          111.63172291313799, 0.0, 0.0, 0.0, 33.419339999999998, 0.0, 0.0, 0.0, 33.419339999999998, 33.419339999999998,
          33.419339999999998, 0.0, 0.0, 0.0, 33.419339999999998, 0.0, 0.0, 0.0, 33.419339999999998, 33.419339999999998,
          33.419339999999998, 0, 0, 0, 1, 0, 0, 0, 1, 1, 1, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 145, 20,
          22, 50.248366013071895, 0.8112550266529959, 152, 34, 23, 46.54901960784313, 0.22559100955089856, 157, 42, 69,
          64.78571428571429, 0.38222252932463885, 180, 24, 0, 65.73809523809524, 1.645480906547594, 171, 24, 5,
          55.87037037037037, 1.0596491531176435, 181, 0, 0, 63.02526315789475, 2.430119034556415, 0.10505784324915912,
          0.11246744733041092, 0.17223246175793738, 0.1267353784195383, -0.016864689408109035, 0.040742549370827,
          0.046932733845445274],
         [20, 6, 13, 0.06133599246678435, 4.956566991363096, 4.568072590294782, 3.1482940974347455, 4.068482713761754,
          5.631525952482117, 5.355211988664981, 5.479172065501725, 0.0, 0.9542425094393249, 1.0, 2800.0, 2963.0, 604.0,
          1420.0, 27.0, 409.0, 24.0]]
        self.assertEqual(results, expected_results)


if __name__ == '__main__':
    unittest.main()
